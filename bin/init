#!/usr/bin/env node

var fs = require('fs');
var lodash = require('lodash');
var mkdirp = require('mkdirp');
var path = require('path');

var pkg = require(path.join(process.cwd(), 'package.json'));
var initDir = path.join(__dirname, '..', 'init');
var files = [
  'src/index.js',
  'src/version.js',
  'test/unit.js',
  '.editorconfig',
  '.eslintignore',
  '.eslintrc',
  '.gitignore',
  '.gulprc',
  '.travis.yml',
  'README.md',
  'bower.json',
  'gulpfile.js'
];

files.forEach(function (file) {
  var src = path.join(initDir, file)
  var dst = path.join(process.cwd(), file);
  fs.readFile(src, function (err, content) {
    fs.exists(dst, function (exists) {
      if (!exists) {
        mkdirp(path.dirname(dst), function () {
          fs.writeFile(dst, lodash.template(content)(pkg));
        });
      }
    });
  });
});
